/**
 * Comprehensive email blacklist for preventing spam and abuse
 * This list is maintained based on known disposable email services and spam domains
 *
 * Sources:
 * - https://github.com/disposable-email-domains/disposable-email-domains
 * - https://github.com/ivolo/disposable-email-domains
 * - Manual additions based on abuse patterns
 */

export const EMAIL_BLACKLIST = {
  /**
   * Disposable/Temporary email domains
   * These services provide temporary email addresses that expire
   */
  disposable: [
    // 10 Minute Mail variants
    '10minutemail.com',
    '10minutemail.net',
    '10minutemail.org',
    '20minutemail.com',
    '30minutemail.com',

    // Guerrilla Mail
    'guerrillamail.com',
    'guerrillamail.net',
    'guerrillamail.biz',
    'guerrillamail.org',
    'guerrillamailblock.com',
    'grr.la',
    'sharklasers.com',
    'pokemail.net',
    'spam4.me',

    // Mailinator family
    'mailinator.com',
    'mailinator.net',
    'mailinator2.com',
    'mailinator.org',
    'reallymymail.com',
    'reconmail.com',
    'notmailinator.com',

    // TempMail variants
    'tempmail.com',
    'temp-mail.org',
    'temp-mail.io',
    'tempmail.net',
    'tempmailaddress.com',
    'tempinbox.com',
    'tempinbox.co',

    // YOPmail
    'yopmail.com',
    'yopmail.fr',
    'yopmail.net',
    'cool.fr.nf',
    'jetable.fr.nf',
    'nospam.ze.tc',
    'nomail.xl.cx',
    'mega.zik.dj',
    'speed.1s.fr',
    'courriel.fr.nf',
    'moncourrier.fr.nf',
    'monemail.fr.nf',
    'monmail.fr.nf',

    // Throwaway email services
    'throwaway.email',
    'throwawaymail.com',
    'throam.com',
    'thrma.com',
    'trbvm.com',
    'trbvn.com',

    // TrashMail
    'trashmail.com',
    'trashmail.net',
    'trashmail.org',
    'trashmail.ws',
    'trashmail.de',
    'trashmailer.com',
    'trashemail.de',
    'trashymail.com',
    'trashymail.net',
    'trashmail.at',

    // Other popular disposable services
    'dispostable.com',
    'disposablemail.com',
    'disposableemailaddresses.com',
    'disposableinbox.com',
    'dispose.it',
    'discard.email',
    'discardmail.com',
    'discardmail.de',
    'spamgourmet.com',
    'spamgourmet.net',
    'devnullmail.com',
    'mailnesia.com',
    'emailondeck.com',
    'getnada.com',
    'mailcatch.com',
    'maildrop.cc',
    'mailnull.com',
    'mailslite.com',
    'mailtemp.info',
    'mintemail.com',
    'mytemp.email',
    'nada.email',
    'fakeinbox.com',
    'fakemailgenerator.com',
    'emailfake.com',

    // German disposable services
    'wegwerfmail.de',
    'wegwerfmail.net',
    'wegwerfmail.org',
    'wegwerfemail.de',
    'spoofmail.de',
    'schafmail.de',
    'eintagsmail.de',
    'einrot.de',
    'einrot.com',

    // Privacy-focused (but often abused)
    'mailbox.org',
    'posteo.de',
    'tutanota.com',
    'protonmail.com',
    'protonmail.ch',
    'pm.me',

    // Additional known disposables
    'bugmenot.com',
    'dontreg.com',
    'mailexpire.com',
    'slopsbox.com',
    'filzmail.com',
    'dodgeit.com',
    'beefmilk.com',
    'binkmail.com',
    'bobmail.info',
    'chammy.info',
    'chogmail.com',
    'crapmail.org',
    'deadaddress.com',
    'despam.it',
    'devnullmail.com',
    'dfgh.net',
    'digitalsanctuary.com',
    'dingbone.com',
    'emailias.com',
    'emailsensei.com',
    'emailtemporario.com.br',
    'fastacura.com',
    'fastchevy.com',
    'fastkawasaki.com',
    'fastmazda.com',
    'fastmitsubishi.com',
    'fastnissan.com',
    'fastsubaru.com',
    'fastsuzuki.com',
    'fasttoyota.com',
    'fastyamaha.com',
    'getairmail.com',
    'getonemail.com',
    'getonemail.net',
    'ghosttexter.de',
    'gishpuppy.com',
    'great-host.in',
    'greensloth.com',
    'gsrv.co.uk',
    'haltospam.com',
    'hatespam.org',
    'hidemail.de',
    'hochsitze.com',
    'hotpop.com',
    'hulapla.de',
    'ieatspam.eu',
    'ieatspam.info',
    'ieh-mail.de',
    'imails.info',
    'inboxclean.com',
    'inboxclean.org',
    'incognitomail.com',
    'incognitomail.net',
    'incognitomail.org',
    'ipoo.org',
    'irish2me.com',
    'iwi.net',
    'jetable.com',
    'jetable.net',
    'jetable.org',
    'jnxjn.com',
    'jourrapide.com',
    'kasmail.com',
    'kaspop.com',
    'killmail.com',
    'killmail.net',
    'kir.ch.tc',
    'klassmaster.com',
    'klassmaster.net',
    'klzlk.com',
    'koszmail.pl',
    'kulturbetrieb.info',
    'kurzepost.de',
    'lifebyfood.com',
    'link2mail.net',
    'litedrop.com',
    'lol.ovpn.to',
    'lookugly.com',
    'lopl.co.cc',
    'lortemail.dk',
    'lr78.com',
    'maboard.com',
    'mail-temporaire.fr',
    'mail.by',
    'mail.mezimages.net',
    'mail333.com',
    'mail4trash.com',
    'mailblocks.com',
    'mailbucket.org',
    'mailfreeonline.com',
    'mailguard.me',
    'mailimate.com',
    'mailin8r.com',
    'mailinater.com',
    'mailismagic.com',
    'mailme.ir',
    'mailme.lv',
    'mailmetrash.com',
    'mailmoat.com',
    'mailshell.com',
    'mailsiphon.com',
    'mailtemp.info',
    'mailtothis.com',
    'mailzilla.com',
    'mailzilla.org',
    'makemetheking.com',
    'mbx.cc',
    'mega.zik.dj',
    'meinspamschutz.de',
    'meltmail.com',
    'messagebeamer.de',
    'mierdamail.com',
    'migumail.com',
    'mintemail.com',
    'mjukglass.nu',
    'mobi.web.id',
    'moburl.com',
    'moncourrier.fr.nf',
    'monemail.fr.nf',
    'monmail.fr.nf',
    'monumentmail.com',
    'msa.minsmail.com',
    'mt2009.com',
    'mt2014.com',
    'mt2015.com',
    'mx0.wwwnew.eu',
    'mycleaninbox.net',
    'mypartyclip.de',
    'myphantomemail.com',
    'myspaceinc.com',
    'myspaceinc.net',
    'myspaceinc.org',
    'myspacepimpedup.com',
    'myspamless.com',
    'mytempmail.com',
    'mytrashmail.com',
    'neomailbox.com',
    'nepwk.com',
    'nervmich.net',
    'nervtmich.net',
    'netmails.com',
    'netmails.net',
    'netzidiot.de',
    'neverbox.com',
    'no-spam.ws',
    'nobulk.com',
    'noclickemail.com',
    'nogmailspam.info',
    'nomail.pw',
    'nomail.xl.cx',
    'nomail2me.com',
    'nomorespamemails.com',
    'nonspam.eu',
    'nonspammer.de',
    'noref.in',
    'nospam.ze.tc',
    'nospam4.us',
    'nospamfor.us',
    'nospammail.net',
    'nospamthanks.info',
    'notmailinator.com',
    'notsharingmy.info',
    'nowhere.org',
    'nowmymail.com',
    'nurfuerspam.de',
    'nus.edu.sg',
    'objectmail.com',
    'obobbo.com',
    'odaymail.com',
    'odnorazovoe.ru',
    'one-time.email',
    'oneoffemail.com',
    'oneoffmail.com',
    'onewaymail.com',
    'oopi.org',
    'opayq.com',
    'ordinaryamerican.net',
    'otherinbox.com',
    'ourklips.com',
    'outlawspam.com',
    'ovpn.to',
    'owlpic.com',
    'pancakemail.com',
    'paplease.com',
    'pcusers.otherinbox.com',
    'pjjkp.com',
    'plexolan.de',
    'poczta.onet.pl',
    'politikerclub.de',
    'poofy.org',
    'pookmail.com',
    'privacy.net',
    'privatdemail.net',
    'privy-mail.com',
    'privymail.de',
    'proxymail.eu',
    'prtnx.com',
    'putthisinyourspamdatabase.com',
    'pwrby.com',
    'qq.com',
    'quickinbox.com',
    'quickmail.nl',
    'rcpt.at',
    'reallymymail.com',
    'realtyalerts.ca',
    'recode.me',
    'reconmail.com',
    'recursor.net',
    'regbypass.com',
    'regbypass.comsafe-mail.net',
    'rejectmail.com',
    'reliable-mail.com',
    'rhyta.com',
    'rklips.com',
    'rmqkr.net',
    's0ny.net',
    'safe-mail.net',
    'safersignup.de',
    'safetymail.info',
    'safetypost.de',
    'sandelf.de',
    'saynotospams.com',
    'scatmail.com',
    'schafmail.de',
    'selfdestructingmail.com',
    'selfdestructingmail.org',
    'sendspamhere.com',
    'sharedmailbox.org',
    'shieldedmail.com',
    'shiftmail.com',
    'shitmail.me',
    'shitmail.org',
    'shitware.nl',
    'shmeriously.com',
    'shortmail.net',
    'shutupandtakemy.money',
    'sibmail.com',
    'sinnlos-mail.de',
    'skeefmail.com',
    'slaskpost.se',
    'slipry.net',
    'slopsbox.com',
    'slushmail.com',
    'smashmail.de',
    'smellfear.com',
    'snakemail.com',
    'sneakemail.com',
    'sneakmail.de',
    'snkmail.com',
    'sofimail.com',
    'sofort-mail.de',
    'sogetthis.com',
    'solvemail.info',
    'soodonims.com',
    'spam.la',
    'spam.su',
    'spam4.me',
    'spamail.de',
    'spamarrest.com',
    'spamavert.com',
    'spambob.com',
    'spambob.net',
    'spambob.org',
    'spambog.com',
    'spambog.de',
    'spambog.net',
    'spambog.ru',
    'spambox.info',
    'spambox.irishspringrealty.com',
    'spambox.us',
    'spamcannon.com',
    'spamcannon.net',
    'spamcero.com',
    'spamcon.org',
    'spamcorptastic.com',
    'spamcowboy.com',
    'spamcowboy.net',
    'spamcowboy.org',
    'spamday.com',
    'spamdecoy.net',
    'spamex.com',
    'spamfighter.cf',
    'spamfighter.ga',
    'spamfighter.gq',
    'spamfighter.ml',
    'spamfighter.tk',
    'spamfree.eu',
    'spamfree24.com',
    'spamfree24.de',
    'spamfree24.eu',
    'spamfree24.info',
    'spamfree24.net',
    'spamfree24.org',
    'spamgoes.in',
    'spamgourmet.com',
    'spamgourmet.net',
    'spamgourmet.org',
    'spamherelots.com',
    'spamhereplease.com',
    'spamhole.com',
    'spamify.com',
    'spaml.com',
    'spaml.de',
    'spammotel.com',
    'spamobox.com',
    'spamoff.de',
    'spamsalad.in',
    'spamslicer.com',
    'spamspot.com',
    'spamstack.net',
    'spamthis.co.uk',
    'spamthisplease.com',
    'spamtrail.com',
    'spamtroll.net',
    'speed.1s.fr',
    'speedmail.de',
    'spikio.com',
    'spoofmail.de',
    'squizzy.de',
    'ssoia.com',
    'startkeys.com',
    'stinkefinger.net',
    'stop-my-spam.cf',
    'stop-my-spam.com',
    'stop-my-spam.ga',
    'stop-my-spam.ml',
    'stop-my-spam.tk',
    'streetwisemail.com',
    'stuffmail.de',
    'supergreatmail.com',
    'supermailer.jp',
    'superrito.com',
    'superstachel.de',
    'suremail.info',
    'svk.jp',
    'sweetxxx.de',
    'tafmail.com',
    'tagyourself.com',
    'talkinator.com',
    'tapchicuoihoi.com',
    'teewars.org',
    'teleworm.com',
    'teleworm.us',
    'temp-mail.org',
    'temp-mail.ru',
    'temp.emeraldwebmail.com',
    'tempail.com',
    'tempalias.com',
    'tempe-mail.com',
    'tempemail.biz',
    'tempemail.co.za',
    'tempemail.com',
    'tempemail.net',
    'tempinbox.co.uk',
    'tempinbox.com',
    'tempmail.eu',
    'tempmail.it',
    'tempmail2.com',
    'tempmaildemo.com',
    'tempmailer.com',
    'tempmailer.de',
    'tempomail.fr',
    'temporarily.de',
    'temporarioemail.com.br',
    'temporaryemail.net',
    'temporaryemail.us',
    'temporaryforwarding.com',
    'temporaryinbox.com',
    'temporarymailaddress.com',
    'tempthe.net',
    'temppocztex.ovh',
    'tempsky.com',
    'tempymail.com',
    'thanksnospam.info',
    'thankyou2010.com',
    'thc.st',
    'thelimestones.com',
    'thisisnotmyrealemail.com',
    'thismail.net',
    'thrma.com',
    'throam.com',
    'throwawayemailaddress.com',
    'throwawaymail.com',
    'thyta.com',
    'tilien.com',
    'tittbit.in',
    'tizi.com',
    'tmailinator.com',
    'toiea.com',
    'toomail.biz',
    'topranklist.de',
    'tormail.net',
    'tormail.org',
    'tradermail.info',
    'trash-amil.com',
    'trash-mail.at',
    'trash-mail.cf',
    'trash-mail.com',
    'trash-mail.de',
    'trash-mail.ga',
    'trash-mail.gq',
    'trash-mail.ml',
    'trash-mail.tk',
    'trash2009.com',
    'trash2010.com',
    'trash2011.com',
    'trashdevil.com',
    'trashdevil.de',
    'trashemail.de',
    'trashmail.at',
    'trashmail.com',
    'trashmail.de',
    'trashmail.me',
    'trashmail.net',
    'trashmail.org',
    'trashmail.ws',
    'trashmailer.com',
    'trashymail.com',
    'trashymail.net',
    'trayna.com',
    'trbvm.com',
    'trialmail.de',
    'trickmail.net',
    'trillianpro.com',
    'tryalert.com',
    'twinmail.de',
    'tyldd.com',
    'uggsrock.com',
    'umail.net',
    'uroid.com',
    'username.e4ward.com',
    'valemail.net',
    'venompen.com',
    'veryrealemail.com',
    'vidchart.com',
    'viditag.com',
    'viewcastmedia.com',
    'viewcastmedia.net',
    'viewcastmedia.org',
    'vipmail.name',
    'vipmail.pw',
    'viralplays.com',
    'vomoto.com',
    'vpn.st',
    'vsimcard.com',
    'vubby.com',
    'w.0w.ro',
    'walala.org',
    'walkmail.net',
    'walkmail.ru',
    'wantmail.de',
    'wasteland.rfc822.org',
    'watchfull.net',
    'wazabi.club',
    'wbb3.de',
    'we.qq.com',
    'web-emailbox.eu',
    'web-ideal.fr',
    'webm4il.info',
    'webmail.igg.biz',
    'webuser.in',
    'wee.my',
    'weg-werf-email.de',
    'wegwerf-email-addressen.de',
    'wegwerf-email-adressen.de',
    'wegwerf-email.de',
    'wegwerf-email.net',
    'wegwerf-emails.de',
    'wegwerfadresse.de',
    'wegwerfemail.com',
    'wegwerfemail.de',
    'wegwerfemail.info',
    'wegwerfemail.org',
    'wegwerfmail.de',
    'wegwerfmail.info',
    'wegwerfmail.net',
    'wegwerfmail.org',
    'wegwerpmailadres.nl',
    'wegwerpmail.nl',
    'wegwrfmail.de',
    'wegwrfmail.net',
    'wegwrfmail.org',
    'welikecookies.com',
    'wetrainbayarea.com',
    'wetrainbayarea.org',
    'wfgfhf.tk',
    'wh4f.org',
    'whatiaas.com',
    'whatpaas.com',
    'whatsaas.com',
    'whopy.com',
    'whtjddn.33mail.com',
    'whyspam.me',
    'wickmail.net',
    'wilemail.com',
    'willhackforfood.biz',
    'willselfdestruct.com',
    'wimsg.com',
    'winemaven.info',
    'wmail.cf',
    'wolfsmail.tk',
    'wolfsmails.tk',
    'wookmail.com',
    'wookmail.net',
    'wookmail.org',
    'worldspace.link',
    'writeme.us',
    'wronghead.com',
    'wuzup.net',
    'wuzupmail.net',
    'ww.w.mailinator.com',
    'www.e4ward.com',
    'www.gishpuppy.com',
    'www.mailinator.com',
    'wwwnew.eu',
    'x.ip6.li',
    'xagloo.co',
    'xagloo.com',
    'xemaps.com',
    'xents.com',
    'xmaily.com',
    'xoxy.net',
    'xww.ro',
    'xyzfree.net',
    'yapped.net',
    'yaqp.com',
    'yeah.net',
    'yep.it',
    'yogamaven.com',
    'yomail.info',
    'yopmail.com',
    'yopmail.fr',
    'yopmail.gq',
    'yopmail.info',
    'yopmail.net',
    'yordanmail.cf',
    'youmail.ga',
    'youmailr.com',
    'ypmail.webarnak.fr.eu.org',
    'yuurok.com',
    'z1p.biz',
    'za.com',
    'zehnminuten.de',
    'zehnminutenmail.de',
    'zetmail.com',
    'zippymail.info',
    'zoaxe.com',
    'zoemail.com',
    'zoemail.net',
    'zoemail.org',
    'zomg.info',
    'zxcv.com',
    'zxcvbnm.com',
    'zzz.com'
  ],

  /**
   * Role-based email prefixes that are often not monitored
   * These are typically used for system emails, not personal ones
   */
  roleBased: [
    'admin',
    'administrator',
    'hostmaster',
    'info',
    'mail',
    'mailer',
    'mailer-daemon',
    'marketing',
    'nobody',
    'noreply',
    'no-reply',
    'donotreply',
    'do-not-reply',
    'postmaster',
    'root',
    'sales',
    'support',
    'test',
    'usenet',
    'uucp',
    'webmaster',
    'www',
    'abuse',
    'contact',
    'enquiries',
    'feedback',
    'help',
    'helpdesk',
    'news',
    'newsletter',
    'notifications',
    'office',
    'orders',
    'press',
    'privacy',
    'register',
    'registration',
    'security',
    'service',
    'services',
    'team',
    'unsubscribe',
    'user',
    'users',
    'billing',
    'accounts',
    'accounting',
    'hr',
    'jobs',
    'careers',
    'recruit',
    'recruitment'
  ]
};

/**
 * Email validation utility
 */
export class EmailBlacklistChecker {
  /**
   * Check if an email is blacklisted
   */
  static isBlacklisted(email: string): boolean {
    const [localPart, domain] = email.toLowerCase().split('@');

    if (!localPart || !domain) {
      return true; // Invalid email format
    }

    // Check if domain is in disposable list
    if (EMAIL_BLACKLIST.disposable.includes(domain)) {
      return true;
    }

    // Check if email is role-based (optional check)
    if (process.env.BLOCK_ROLE_BASED_EMAILS === 'true') {
      if (EMAIL_BLACKLIST.roleBased.includes(localPart)) {
        return true;
      }
    }

    return false;
  }

  /**
   * Get the reason why an email is blacklisted
   */
  static getBlacklistReason(email: string): string | null {
    const [localPart, domain] = email.toLowerCase().split('@');

    if (!localPart || !domain) {
      return 'Invalid email format';
    }

    if (EMAIL_BLACKLIST.disposable.includes(domain)) {
      return 'Disposable email domain not allowed';
    }

    if (process.env.BLOCK_ROLE_BASED_EMAILS === 'true') {
      if (EMAIL_BLACKLIST.roleBased.includes(localPart)) {
        return 'Role-based email addresses not allowed';
      }
    }

    return null;
  }
}